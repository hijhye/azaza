<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ì•„ìì ëŒ€ì‹œë³´ë“œ</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
        <style>
            @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

            :root {
                /* ìš”ì²­í•˜ì‹  ë°ê³  ì‹œì›í•œ ì–¼ìŒ íŒŒë€ìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
                --bg-day: linear-gradient(135deg, #aee1f9 0%, #f0f9ff 100%);
                --card-bg: rgba(255, 255, 255, 0.85);
                --primary: #0077c2; /* ì„ ëª…í•œ íŒŒë€ìƒ‰ */
                --blue: #4fc3f7; /* ë°ì€ í•˜ëŠ˜ìƒ‰ */
                --text: #2c3e50; /* ë¶€ë“œëŸ¬ìš´ ì§„í•œ íšŒìƒ‰ */
                --text-sub: #78909c; /* ë¶€ë“œëŸ¬ìš´ íšŒìƒ‰ */
            }
            body {
                font-family: 'Pretendard', sans-serif;
                background: var(--bg-day);
                background-attachment: fixed;
                min-height: 100vh;
                margin: 0;
                padding: 20px;
                display: flex;
                flex-direction: column;
                align-items: center;
                color: var(--text);
                padding-bottom: 160px;
                transition: background 0.5s ease;
                user-select: none;
            }
            .container {
                width: 100%;
                max-width: 550px;
            }

            /* í—¤ë” ìŠ¤íƒ€ì¼ */
            .header-bar {
                display: flex;
                align-items: center;
                justify-content: space-between;
                background: rgba(255, 255, 255, 0.3);
                backdrop-filter: blur(10px);
                padding: 15px 20px;
                border-radius: 20px;
                border: 1px solid rgba(255, 255, 255, 0.5);
                margin-bottom: 25px;
                color: var(--primary);
            }
            .header-left {
                display: flex;
                align-items: baseline;
                gap: 12px;
            }
            .d-day {
                font-size: 2.2rem;
                font-weight: 900;
                color: var(--primary);
                text-shadow: 0 2px 5px rgba(0, 119, 194, 0.2);
            }
            .today-date {
                font-size: 1.1rem;
                font-weight: 500;
                opacity: 0.9;
                color: var(--text);
            }

            .tab-menu {
                display: flex;
                gap: 8px;
            }
            .tab-btn {
                background: rgba(255, 255, 255, 0.4);
                border: 1px solid rgba(255, 255, 255, 0.6);
                color: var(--primary);
                padding: 8px 16px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 0.9rem;
                transition: 0.3s;
            }
            .tab-btn.active {
                background: white;
                color: var(--blue);
                font-weight: bold;
                border-color: white;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }

            /* ì¹´ë“œ ë° í•­ëª© */
            .card {
                background: var(--card-bg);
                border-radius: 24px;
                padding: 25px;
                box-shadow: 0 15px 35px rgba(0, 119, 194, 0.1);
                position: relative;
                backdrop-filter: blur(10px);
            }
            .section-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 20px;
            }
            .section-title-main {
                font-size: 1.3rem;
                font-weight: 800;
                color: var(--primary);
            }
            .btn-edit-global {
                background: #e1f5fe;
                border: none;
                padding: 8px 14px;
                border-radius: 10px;
                font-size: 0.8rem;
                color: var(--blue);
                cursor: pointer;
                font-weight: 700;
                transition: 0.2s;
            }
            .btn-edit-global:hover {
                background: #b3e5fc;
            }

            .task-item {
                display: flex;
                align-items: flex-start;
                gap: 15px;
                margin-bottom: 12px;
                padding: 15px;
                background: #fff;
                border-radius: 16px;
                border: 1px solid #e1f5fe;
                cursor: grab;
                transition: transform 0.2s, box-shadow 0.2s;
            }
            .task-item:active {
                cursor: grabbing;
                box-shadow: 0 5px 15px rgba(0, 119, 194, 0.1);
                border-color: var(--blue);
            }
            .sortable-ghost {
                opacity: 0.7;
                background: #e1f5fe !important;
                border: 2px dashed var(--blue) !important;
            }

            input[type='checkbox'] {
                width: 24px;
                height: 24px;
                cursor: pointer;
                accent-color: var(--blue);
                margin-top: 2px;
            }
            .task-info.done .content {
                text-decoration: line-through;
                color: var(--text-sub);
            }
            .label {
                font-size: 0.8rem;
                color: var(--text-sub);
                font-weight: 700;
                margin-bottom: 4px;
                display: block;
            }
            .content {
                font-size: 1.05rem;
                font-weight: 600;
                line-height: 1.5;
                color: var(--text);
                pointer-events: none;
            }

            /* ì§„í–‰ë¥  ë°” */
            .progress-section {
                margin-top: 25px;
                padding-top: 20px;
                border-top: 2px dashed #e1f5fe;
            }
            .progress-container {
                background: #e1f5fe;
                border-radius: 10px;
                height: 12px;
                overflow: hidden;
            }
            .progress-bar {
                background: var(--blue);
                height: 100%;
                width: 0%;
                transition: width 0.6s ease;
            }
            .progress-text {
                font-size: 0.85rem;
                color: var(--blue);
                text-align: right;
                margin-top: 8px;
                font-weight: 800;
            }

            .view-section {
                display: none;
            }
            .view-section.active {
                display: block;
            }
            .list-item {
                display: flex;
                padding: 18px 10px;
                border-bottom: 1px solid #e1f5fe;
                cursor: pointer;
                transition: 0.2s;
            }
            .list-item:hover {
                background: #f1faff;
            }

            /* í•˜ë‹¨ ì‹œê³„ */
            .bottom-clock-area {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                background: rgba(255, 255, 255, 0.5);
                backdrop-filter: blur(20px);
                padding: 25px 0;
                text-align: center;
                color: var(--primary);
                border-top: 1px solid rgba(255, 255, 255, 0.5);
                z-index: 1000;
                box-shadow: 0 -5px 20px rgba(0, 119, 194, 0.1);
            }
            .big-clock {
                font-size: 5rem;
                font-weight: 900;
                letter-spacing: -4px;
                line-height: 1;
                font-variant-numeric: tabular-nums;
                text-shadow: 0 2px 10px rgba(255, 255, 255, 0.5);
            }

            #modal {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 119, 194, 0.2);
                z-index: 2000;
                justify-content: center;
                align-items: center;
                backdrop-filter: blur(5px);
            }
            .modal-content {
                background: white;
                padding: 30px;
                border-radius: 24px;
                width: 90%;
                max-width: 400px;
                box-shadow: 0 10px 30px rgba(0, 119, 194, 0.2);
            }
            input,
            textarea {
                width: 100%;
                padding: 14px;
                margin-bottom: 12px;
                border: 1px solid #b3e5fc;
                border-radius: 12px;
                box-sizing: border-box;
                font-family: inherit;
                color: var(--text);
            }
            input:focus,
            textarea:focus {
                outline: none;
                border-color: var(--blue);
                box-shadow: 0 0 0 3px rgba(79, 195, 247, 0.2);
            }
            .btn-save {
                width: 100%;
                background: var(--blue);
                color: white;
                border: none;
                padding: 16px;
                border-radius: 12px;
                cursor: pointer;
                font-size: 1.1rem;
                font-weight: bold;
                transition: 0.2s;
            }
            .btn-save:hover {
                background: var(--primary);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header-bar">
                <div class="header-left">
                    <div class="d-day" id="d-day-display">D-27</div>
                    <div class="today-date" id="header-date">01.13 ì›”</div>
                </div>
                <div class="tab-menu">
                    <button
                        class="tab-btn active"
                        id="tab-today"
                        onclick="switchView('today')"
                    >
                        ì˜¤ëŠ˜
                    </button>
                    <button
                        class="tab-btn"
                        id="tab-all"
                        onclick="switchView('all')"
                    >
                        ì „ì²´
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="section-header">
                    <div class="section-title-main" id="view-title">
                        Today's Focus
                    </div>
                    <button
                        class="btn-edit-global"
                        id="btn-edit-main"
                        onclick="openEditToday()"
                    >
                        ì „ì²´ ìˆ˜ì •
                    </button>
                </div>

                <div id="view-today" class="view-section active">
                    <div id="today-tasks-container"></div>
                    <div class="progress-section">
                        <div class="progress-container">
                            <div id="progress-bar" class="progress-bar"></div>
                        </div>
                        <div id="progress-text" class="progress-text">
                            ì§„í–‰ë¥  0%
                        </div>
                    </div>
                </div>

                <div id="view-all" class="view-section">
                    <div
                        id="full-list-container"
                        style="max-height: 55vh; overflow-y: auto"
                    ></div>
                </div>
            </div>
        </div>

        <div class="bottom-clock-area">
            <div id="big-clock" class="big-clock">00:00:00</div>
        </div>

        <div id="modal">
            <div class="modal-content">
                <h3 style="margin-top: 0; color: var(--primary)">
                    ì¼ì • ë°ì´í„° ìˆ˜ì •
                </h3>
                <input type="text" id="in-date" placeholder="ë‚ ì§œ (MM-DD)" />
                <input type="text" id="in-general" placeholder="ğŸƒ ì¼ë°˜ ì¼ì •" />
                <input
                    type="text"
                    id="in-exam-cat"
                    placeholder="ğŸ“š ì‹œí—˜ ë¶„ë¥˜"
                />
                <textarea
                    id="in-exam-note"
                    placeholder="ğŸ“š ê³µë¶€ ë‚´ìš©"
                    rows="2"
                ></textarea>
                <input
                    type="text"
                    id="in-job-note"
                    placeholder="ğŸ’¼ ì·¨ì—… ì¤€ë¹„"
                />
                <input type="text" id="in-side" placeholder="ğŸ’° ë¶€ìˆ˜ì…" />
                <button class="btn-save" onclick="saveData()">ì €ì¥í•˜ê¸°</button>
                <button
                    onclick="closeModal()"
                    style="
                        width: 100%;
                        background: none;
                        border: none;
                        margin-top: 15px;
                        color: var(--text-sub);
                        cursor: pointer;
                    "
                >
                    ì·¨ì†Œ
                </button>
            </div>
        </div>

        <script>
            const EXAM_DATE = new Date('2026-02-08');

            // ì´ë¯¸ì§€ì˜ ëª¨ë“  ë°ì´í„° ë³µêµ¬
            const INITIAL_DATA = [
                {
                    date: '01-13',
                    general: '',
                    exam: { cat: 'í•µì‹¬ìš”ì•½', note: '1íšŒë…' },
                    job: { note: 'íŒ€í”Œ ì™„ì„±í•˜ê¸°' },
                    side: 'ìƒì„¸í˜ì´ì§€ ë§Œë“¤ê¸°',
                    done: [],
                },
                {
                    date: '01-14',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'í•µì‹¬ìš”ì•½', note: '2íšŒë…' },
                    job: { note: 'ìë°”ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œì íŠ¸ ë°˜ì‘í˜• ì™„ì„±í•˜ê¸°' },
                    side: 'ìƒì„¸í˜ì´ì§€ ë§Œë“¤ê¸°',
                    done: [],
                },
                {
                    date: '01-15',
                    general: '',
                    exam: {
                        cat: 'í•µì‹¬ìš”ì•½',
                        note: '3íšŒë… + ë‚´ìš© ë‚´ê°€ ì•Œì•„ë³´ê¸° ì‰½ê²Œ ì •ë¦¬',
                    },
                    job: { note: 'ìë°”ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œì íŠ¸ ë°˜ì‘í˜• ì™„ì„±í•˜ê¸°' },
                    side: 'ìƒì„¸í˜ì´ì§€ ë§Œë“¤ê¸°',
                    done: [],
                },
                {
                    date: '01-16',
                    general: 'ìˆ˜ì˜, êµ­ì·¨ìƒë‹´',
                    exam: {
                        cat: 'í•µì‹¬ìš”ì•½',
                        note: '3íšŒë… + ë‚´ìš© ë‚´ê°€ ì•Œì•„ë³´ê¸° ì‰½ê²Œ ì •ë¦¬',
                    },
                    job: { note: 'ìì†Œì„œ 1ì°¨ ì‘ì„±' },
                    side: 'ìƒì„¸í˜ì´ì§€ ë§Œë“¤ê¸°',
                    done: [],
                },
                {
                    date: '01-17',
                    general: 'ì•Œë°”',
                    exam: {
                        cat: 'í•µì‹¬ìš”ì•½',
                        note: '3íšŒë… + ë‚´ìš© ë‚´ê°€ ì•Œì•„ë³´ê¸° ì‰½ê²Œ ì •ë¦¬',
                    },
                    job: { note: 'ì ê²€í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-18',
                    general: 'ì•Œë°”, êµíšŒ',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸' },
                    job: { note: 'ì ê²€í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-19',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '1íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'í¬íŠ¸í´ë¦¬ì˜¤ ì‚¬ì´íŠ¸ ì™„ì„±í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-20',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '2íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'í¬íŠ¸í´ë¦¬ì˜¤ ì‚¬ì´íŠ¸ ì™„ì„±í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-21',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '3íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'í¬íŠ¸í´ë¦¬ì˜¤ í”„ë¡œì íŠ¸ë“¤ ê¸°íšì„œ ì‘ì„±í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-22',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '4íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: {
                        note: 'ë¦¬ì•¡íŠ¸ ì‚¬ì´íŠ¸ ì œëŒ€ë¡œ ë‹¤ì‹œ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ê¸°',
                    },
                    side: '',
                    done: [],
                },
                {
                    date: '01-23',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '5íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: {
                        note: 'ë¦¬ì•¡íŠ¸ ì‚¬ì´íŠ¸ ì œëŒ€ë¡œ ë‹¤ì‹œ ê¹”ë”í•˜ê²Œ ì •ë¦¬í•˜ê¸°',
                    },
                    side: '',
                    done: [],
                },
                {
                    date: '01-24',
                    general: 'ì•Œë°”',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '6íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'ìì†Œì„œ 2ì°¨ ìˆ˜ì •' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-25',
                    general: 'ì•Œë°”, êµíšŒ',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'ì ê²€í•˜ê¸°' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-26',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '7íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: 'ì…ì‚¬ì§€ì›í•˜ê¸°..ëœëœ' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-27',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '8íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-28',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '9íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-29',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '10íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-30',
                    general: 'ìˆ˜ì˜',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '11íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '01-31',
                    general: 'ì•Œë°”',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '12íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-01',
                    general: 'êµíšŒ',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-02',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '13íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-03',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '14íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-04',
                    general: '',
                    exam: { cat: 'ê¸°ì¶œë¬¸ì œ', note: '15íšŒ ë¬¸ì œí’€ì´ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-05',
                    general: '',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-06',
                    general: '',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-07',
                    general: '',
                    exam: { cat: 'ë³µìŠµ', note: 'í•µì‹¬ìš”ì•½ ë…¸íŠ¸ + ì˜¤ë‹µë…¸íŠ¸' },
                    job: { note: '-' },
                    side: '',
                    done: [],
                },
                {
                    date: '02-08',
                    general: 'ì‹œí—˜ë‹¹ì¼',
                    exam: { cat: 'ì‹œí—˜', note: 'í•©ê²©í•˜ê¸°!! ë‘ë‘¥' },
                    job: { note: 'ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤!' },
                    side: '',
                    done: [],
                },
            ];

            let schedules =
                JSON.parse(localStorage.getItem('mySchedules')) || INITIAL_DATA;
            if (schedules.length < 25) {
                schedules = INITIAL_DATA;
                localStorage.setItem('mySchedules', JSON.stringify(schedules));
            }

            function updateClock() {
                const now = new Date();
                document.getElementById('big-clock').innerText = now
                    .toTimeString()
                    .split(' ')[0];
            }
            setInterval(updateClock, 1000);
            updateClock();

            let sortable;
            function initSortable() {
                const el = document.getElementById('today-tasks-container');
                if (sortable) sortable.destroy();
                sortable = Sortable.create(el, {
                    animation: 200,
                    ghostClass: 'sortable-ghost',
                    onEnd: function () {
                        localStorage.setItem(
                            'mySchedules',
                            JSON.stringify(schedules)
                        );
                    },
                });
            }

            function switchView(view) {
                const editBtn = document.getElementById('btn-edit-main');
                document
                    .querySelectorAll('.view-section')
                    .forEach((el) => el.classList.remove('active'));
                document
                    .querySelectorAll('.tab-btn')
                    .forEach((el) => el.classList.remove('active'));

                if (view === 'today') {
                    document
                        .getElementById('view-today')
                        .classList.add('active');
                    document
                        .getElementById('tab-today')
                        .classList.add('active');
                    document.getElementById('view-title').innerText =
                        "Today's Focus";
                    editBtn.style.display = 'block';
                    renderToday();
                    initSortable();
                } else {
                    document.getElementById('view-all').classList.add('active');
                    document.getElementById('tab-all').classList.add('active');
                    document.getElementById('view-title').innerText =
                        'Full Schedule';
                    editBtn.style.display = 'none';
                    renderAll();
                }
            }

            function renderToday() {
                const now = new Date();
                const mm = String(now.getMonth() + 1).padStart(2, '0');
                const dd = String(now.getDate()).padStart(2, '0');
                const todayStr = `${mm}-${dd}`;
                const data = schedules.find((s) => s.date === todayStr);

                const diff =
                    EXAM_DATE -
                    new Date(now.getFullYear(), now.getMonth(), now.getDate());
                document.getElementById(
                    'd-day-display'
                ).innerText = `D-${Math.ceil(diff / (1000 * 60 * 60 * 24))}`;
                document.getElementById(
                    'header-date'
                ).innerText = `${mm}.${dd} ${
                    ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][now.getDay()]
                }`;

                const container = document.getElementById(
                    'today-tasks-container'
                );
                if (!data) {
                    container.innerHTML = `<p style="text-align:center; padding:40px; color:var(--text-sub);">ì˜¤ëŠ˜ì€ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
                    updateProgress(0, 0);
                    return;
                }

                const tasks = [
                    {
                        id: 'exam',
                        label: `ğŸ“š ì •ì²˜ê¸° (${data.exam.cat})`,
                        content: data.exam.note,
                    },
                    {
                        id: 'job',
                        label: 'ğŸ’¼ ì·¨ì—… ì¤€ë¹„',
                        content: data.job.note,
                    },
                    {
                        id: 'general',
                        label: 'ğŸƒ ì¼ë°˜ ì¼ì •',
                        content: data.general,
                    },
                    { id: 'side', label: 'ğŸ’° ë¶€ìˆ˜ì… ì‘ì—…', content: data.side },
                ].filter(
                    (t) => t.content && t.content !== '-' && t.content !== ''
                );

                container.innerHTML = tasks
                    .map(
                        (t) => `
        <div class="task-item">
            <input type="checkbox" ${
                data.done && data.done.includes(t.id) ? 'checked' : ''
            } onchange="toggleTask('${todayStr}', '${t.id}')">
            <div class="task-info ${
                data.done && data.done.includes(t.id) ? 'done' : ''
            }">
                <span class="label">${t.label}</span>
                <div class="content">${t.content}</div>
            </div>
        </div>
    `
                    )
                    .join('');
                updateProgress(data.done ? data.done.length : 0, tasks.length);
            }

            function toggleTask(date, taskId) {
                const data = schedules.find((s) => s.date === date);
                if (!data.done) data.done = [];
                if (data.done.includes(taskId))
                    data.done = data.done.filter((id) => id !== taskId);
                else data.done.push(taskId);
                localStorage.setItem('mySchedules', JSON.stringify(schedules));
                renderToday();
            }

            function updateProgress(done, total) {
                const percent =
                    total === 0 ? 0 : Math.round((done / total) * 100);
                document.getElementById('progress-bar').style.width =
                    percent + '%';
                document.getElementById(
                    'progress-text'
                ).innerText = `ì§„í–‰ë¥  ${percent}%`;
            }

            function renderAll() {
                const container = document.getElementById(
                    'full-list-container'
                );
                schedules.sort((a, b) => a.date.localeCompare(b.date));
                container.innerHTML = schedules
                    .map(
                        (s) => `
        <div class="list-item" onclick="openModal('${s.date}')">
            <div style="width:50px; font-weight:800; color:var(--blue); font-size:0.85rem;">${
                s.date
            }</div>
            <div style="flex:1;">
                <div style="font-weight:700; color:var(--text); font-size:0.95rem;">
                    ${s.exam.note ? `<div>ğŸ“š ${s.exam.note}</div>` : ''}
                    ${
                        (s.job.note || s.job) &&
                        s.job.note !== '-' &&
                        s.job !== '-'
                            ? `<div>ğŸ’¼ ${s.job.note}</div>`
                            : ''
                    }
                </div>
                <div style="font-size:0.8rem; color:var(--text-sub); margin-top:5px; line-height:1.5;">
                    ${s.general ? `<div>ğŸƒ ${s.general}</div>` : ''}
                    ${s.side ? `<div>ğŸ’° ${s.side}</div>` : ''}
                </div>
            </div>
            <div style="color:#b3e5fc; align-self:center;">â¯</div>
        </div>
    `
                    )
                    .join('');
            }

            function openEditToday() {
                const now = new Date();
                openModal(
                    `${String(now.getMonth() + 1).padStart(2, '0')}-${String(
                        now.getDate()
                    ).padStart(2, '0')}`
                );
            }

            function openModal(date) {
                const target = schedules.find((s) => s.date === date);
                document.getElementById('in-date').value = date;
                document.getElementById('in-general').value = target
                    ? target.general
                    : '';
                document.getElementById('in-exam-cat').value = target
                    ? target.exam.cat
                    : '';
                document.getElementById('in-exam-note').value = target
                    ? target.exam.note
                    : '';
                document.getElementById('in-job-note').value = target
                    ? target.job.note || target.job
                    : '';
                document.getElementById('in-side').value = target
                    ? target.side
                    : '';
                document.getElementById('modal').style.display = 'flex';
            }

            function closeModal() {
                document.getElementById('modal').style.display = 'none';
            }

            function saveData() {
                const date = document.getElementById('in-date').value;
                const newData = {
                    date,
                    general: document.getElementById('in-general').value,
                    exam: {
                        cat: document.getElementById('in-exam-cat').value,
                        note: document.getElementById('in-exam-note').value,
                    },
                    job: { note: document.getElementById('in-job-note').value },
                    side: document.getElementById('in-side').value,
                };
                const idx = schedules.findIndex((s) => s.date === date);
                if (idx > -1)
                    schedules[idx] = { ...schedules[idx], ...newData };
                else {
                    newData.done = [];
                    schedules.push(newData);
                }
                localStorage.setItem('mySchedules', JSON.stringify(schedules));
                closeModal();
                renderToday();
                renderAll();
            }

            renderToday();
        </script>
    </body>
</html>
